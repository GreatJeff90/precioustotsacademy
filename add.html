<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- Firebase SDK -->
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDICSnOljUx6sB_sFJPFgkNfpCkpWMvbCg",
    authDomain: "precioustots-27b2e.firebaseapp.com",
    projectId: "precioustots-27b2e",
    storageBucket: "precioustots-27b2e.firebasestorage.app",
    messagingSenderId: "714734694539",
    appId: "1:714734694539:web:1c6a5802b02deafeb6648e",
    measurementId: "G-8R965ZE37L"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  const googleProvider = new GoogleAuthProvider();

  // Make auth available globally
  window.firebaseAuth = auth;
  window.firebaseGoogleProvider = googleProvider;
  window.firebaseApp = app;
</script>

<!-- ===== Login Modal ===== -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content auth-card">
      <div class="modal-header border-0">
        <h5 class="modal-title auth-title" id="loginModalLabel">Login to Your Account</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="auth-icon">
          <i class="bi bi-person-check"></i>
        </div>
        
        <!-- Google Sign In Button -->
        <button class="google-signin-btn w-100 mb-4" id="googleLoginBtn">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google" class="google-logo">
          Continue with Google
        </button>
        
        <div class="divider mb-4">
          <span>or</span>
        </div>
        
        <form id="loginForm">
          <div class="mb-3">
            <label for="loginEmail" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email" required>
          </div>
          <div class="mb-3">
            <label for="loginPassword" class="form-label">Password</label>
            <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password" required>
          </div>
          <div class="mb-3 form-check d-flex justify-content-between align-items-center">
            <div>
              <input type="checkbox" class="form-check-input" id="rememberMe">
              <label class="form-check-label" for="rememberMe">Remember me</label>
            </div>
            <a href="#" class="auth-link" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal" data-bs-dismiss="modal">Forgot password?</a>
          </div>
          <button type="submit" class="auth-btn">
            <span class="btn-text">Login</span>
            <div class="spinner-border spinner-border-sm d-none" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </button>
        </form>
        
        <div class="text-center mt-3">
          <span class="text-muted">Don't have an account? </span>
          <a href="#" class="auth-link" data-bs-toggle="modal" data-bs-target="#signupModal" data-bs-dismiss="modal">Sign up</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== Signup Modal ===== -->
<div class="modal fade" id="signupModal" tabindex="-1" aria-labelledby="signupModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content auth-card">
      <div class="modal-header border-0">
        <h5 class="modal-title auth-title" id="signupModalLabel">Create an Account</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="auth-icon">
          <i class="bi bi-person-plus"></i>
        </div>
        
        <!-- Google Sign Up Button -->
        <button class="google-signin-btn w-100 mb-4" id="googleSignupBtn">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google" class="google-logo">
          Sign up with Google
        </button>
        
        <div class="divider mb-4">
          <span>or</span>
        </div>
        
        <form id="signupForm">
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="firstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="firstName" placeholder="Enter your first name" required>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="lastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="lastName" placeholder="Enter your last name" required>
              </div>
            </div>
          </div>
          <div class="mb-3">
            <label for="signupEmail" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="signupEmail" placeholder="Enter your email" required>
          </div>
          <div class="mb-3">
            <label for="signupPassword" class="form-label">Password</label>
            <input type="password" class="form-control" id="signupPassword" placeholder="Create a password" required>
            <div class="form-text">Password must be at least 6 characters long</div>
          </div>
          <div class="mb-3">
            <label for="confirmPassword" class="form-label">Confirm Password</label>
            <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm your password" required>
          </div>
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="agreeTerms" required>
            <label class="form-check-label" for="agreeTerms">I agree to the <a href="#" class="auth-link">Terms and Conditions</a></label>
          </div>
          <button type="submit" class="auth-btn">
            <span class="btn-text">Create Account</span>
            <div class="spinner-border spinner-border-sm d-none" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </button>
        </form>
        
        <div class="text-center mt-3">
          <span class="text-muted">Already have an account? </span>
          <a href="#" class="auth-link" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Login</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== Forgot Password Modal ===== -->
<div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content auth-card">
      <div class="modal-header border-0">
        <h5 class="modal-title auth-title" id="forgotPasswordModalLabel">Reset Your Password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="auth-icon">
          <i class="bi bi-key"></i>
        </div>
        <p class="text-center mb-4">Enter your email address and we'll send you a link to reset your password.</p>
        <form id="forgotPasswordForm">
          <div class="mb-3">
            <label for="forgotEmail" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="forgotEmail" placeholder="Enter your email" required>
          </div>
          <button type="submit" class="auth-btn">
            <span class="btn-text">Send Reset Link</span>
            <div class="spinner-border spinner-border-sm d-none" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </button>
        </form>
        <a href="#" class="auth-link text-center mt-3 d-block" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Back to Login</a>
      </div>
    </div>
  </div>
</div>

<style>
  /* Google Sign In Button Styles */
  .google-signin-btn {
    background: white;
    color: #757575;
    border: 1px solid #dadce0;
    padding: 12px 16px;
    border-radius: 10px;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }

  .google-signin-btn:hover {
    background: #f8f9fa;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
  }

  .google-signin-btn:active {
    transform: translateY(0);
  }

  .google-logo {
    width: 18px;
    height: 18px;
  }

  /* Divider Styles */
  .divider {
    position: relative;
    text-align: center;
  }

  .divider::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background: var(--text);
    opacity: 0.2;
  }

  .divider span {
    background: var(--bg);
    padding: 0 16px;
    color: var(--text);
    opacity: 0.7;
    font-size: 14px;
  }

  /* Loading state for buttons */
  .auth-btn .spinner-border {
    width: 1rem;
    height: 1rem;
  }

  .auth-btn .btn-text {
    display: inline-block;
  }

  .auth-btn.loading .btn-text {
    display: none;
  }

  .auth-btn.loading .spinner-border {
    display: inline-block !important;
  }

  /* Dark theme adjustments */
  [data-theme="dark"] .google-signin-btn {
    background: #2d3748;
    color: #e2e8f0;
    border-color: #4a5568;
  }

  [data-theme="dark"] .google-signin-btn:hover {
    background: #4a5568;
  }

  /* Success/Error Messages */
  .alert-message {
    padding: 12px 16px;
    border-radius: 8px;
    margin-bottom: 16px;
    font-size: 14px;
  }

  .alert-success {
    background: rgba(76, 175, 80, 0.1);
    color: #2e7d32;
    border: 1px solid rgba(76, 175, 80, 0.2);
  }

  .alert-error {
    background: rgba(244, 67, 54, 0.1);
    color: #c62828;
    border: 1px solid rgba(244, 67, 54, 0.2);
  }
</style>

<script>
  // Firebase Authentication Functions
  function showAlert(message, type = 'error') {
    // Remove existing alerts
    document.querySelectorAll('.alert-message').forEach(alert => alert.remove());
    
    const alert = document.createElement('div');
    alert.className = `alert-message alert-${type}`;
    alert.textContent = message;
    
    // Insert at the top of modal body
    const modalBody = document.querySelector('.modal.show .modal-body');
    if (modalBody) {
      modalBody.insertBefore(alert, modalBody.firstChild);
    }
    
    // Auto remove after 5 seconds
    setTimeout(() => {
      alert.remove();
    }, 5000);
  }

  function setButtonLoading(button, isLoading) {
    if (isLoading) {
      button.classList.add('loading');
      button.disabled = true;
    } else {
      button.classList.remove('loading');
      button.disabled = false;
    }
  }

  // Google Authentication
  async function signInWithGoogle() {
    try {
      const result = await signInWithPopup(window.firebaseAuth, window.firebaseGoogleProvider);
      const user = result.user;
      
      showAlert(`Welcome, ${user.displayName || user.email}!`, 'success');
      
      // Close modal
      const modal = bootstrap.Modal.getInstance(document.querySelector('.modal.show'));
      if (modal) {
        setTimeout(() => modal.hide(), 1500);
      }
      
      // Update UI for logged-in user
      updateNavigationForLoggedInUser(user);
      
    } catch (error) {
      console.error('Google authentication error:', error);
      showAlert('Google authentication failed. Please try again.');
    }
  }

  // Email/Password Sign Up
  document.getElementById('signupForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const firstName = document.getElementById('firstName').value;
    const lastName = document.getElementById('lastName').value;
    const email = document.getElementById('signupEmail').value;
    const password = document.getElementById('signupPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const submitButton = this.querySelector('.auth-btn');
    
    // Basic validation
    if (!firstName || !lastName || !email || !password || !confirmPassword) {
      showAlert('Please fill in all fields');
      return;
    }
    
    if (password !== confirmPassword) {
      showAlert('Passwords do not match');
      return;
    }
    
    if (password.length < 6) {
      showAlert('Password must be at least 6 characters long');
      return;
    }
    
    if (!document.getElementById('agreeTerms').checked) {
      showAlert('Please agree to the Terms and Conditions');
      return;
    }
    
    try {
      setButtonLoading(submitButton, true);
      
      const userCredential = await createUserWithEmailAndPassword(window.firebaseAuth, email, password);
      const user = userCredential.user;
      
      showAlert('Account created successfully! Welcome to Precious Tots Academy!', 'success');
      
      // Reset form
      this.reset();
      
      // Close modal after success
      setTimeout(() => {
        const modal = bootstrap.Modal.getInstance(document.getElementById('signupModal'));
        if (modal) modal.hide();
      }, 2000);
      
    } catch (error) {
      console.error('Signup error:', error);
      let errorMessage = 'Signup failed. Please try again.';
      
      if (error.code === 'auth/email-already-in-use') {
        errorMessage = 'This email is already registered. Please use a different email or login.';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = 'Please enter a valid email address.';
      } else if (error.code === 'auth/weak-password') {
        errorMessage = 'Password is too weak. Please choose a stronger password.';
      }
      
      showAlert(errorMessage);
    } finally {
      setButtonLoading(submitButton, false);
    }
  });

  // Email/Password Login
  document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    const submitButton = this.querySelector('.auth-btn');
    
    if (!email || !password) {
      showAlert('Please fill in all fields');
      return;
    }
    
    try {
      setButtonLoading(submitButton, true);
      
      const userCredential = await signInWithEmailAndPassword(window.firebaseAuth, email, password);
      const user = userCredential.user;
      
      showAlert(`Welcome back, ${user.email}!`, 'success');
      
      // Reset form
      this.reset();
      
      // Close modal after success
      setTimeout(() => {
        const modal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
        if (modal) modal.hide();
      }, 1500);
      
      // Update UI for logged-in user
      updateNavigationForLoggedInUser(user);
      
    } catch (error) {
      console.error('Login error:', error);
      let errorMessage = 'Login failed. Please check your credentials and try again.';
      
      if (error.code === 'auth/invalid-credential') {
        errorMessage = 'Invalid email or password. Please try again.';
      } else if (error.code === 'auth/user-not-found') {
        errorMessage = 'No account found with this email. Please sign up first.';
      } else if (error.code === 'auth/wrong-password') {
        errorMessage = 'Incorrect password. Please try again.';
      } else if (error.code === 'auth/too-many-requests') {
        errorMessage = 'Too many failed attempts. Please try again later.';
      }
      
      showAlert(errorMessage);
    } finally {
      setButtonLoading(submitButton, false);
    }
  });

  // Password Reset
  document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const email = document.getElementById('forgotEmail').value;
    const submitButton = this.querySelector('.auth-btn');
    
    if (!email) {
      showAlert('Please enter your email address');
      return;
    }
    
    try {
      setButtonLoading(submitButton, true);
      
      await sendPasswordResetEmail(window.firebaseAuth, email);
      
      showAlert('Password reset email sent! Check your inbox for instructions.', 'success');
      
      // Reset form
      this.reset();
      
      // Close modal after success
      setTimeout(() => {
        const modal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
        if (modal) modal.hide();
      }, 3000);
      
    } catch (error) {
      console.error('Password reset error:', error);
      let errorMessage = 'Failed to send reset email. Please try again.';
      
      if (error.code === 'auth/user-not-found') {
        errorMessage = 'No account found with this email address.';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = 'Please enter a valid email address.';
      }
      
      showAlert(errorMessage);
    } finally {
      setButtonLoading(submitButton, false);
    }
  });

  // Attach Google auth to both buttons
  document.getElementById('googleLoginBtn').addEventListener('click', signInWithGoogle);
  document.getElementById('googleSignupBtn').addEventListener('click', signInWithGoogle);

  // Update navigation when user is logged in
  function updateNavigationForLoggedInUser(user) {
    const loginBtn = document.querySelector('.login-btn');
    if (loginBtn) {
      const displayName = user.displayName || user.email.split('@')[0];
      loginBtn.innerHTML = `<i class="bi bi-person-check me-1"></i> ${displayName}`;
      loginBtn.setAttribute('data-bs-toggle', 'dropdown');
      
      // Create dropdown menu if it doesn't exist
      if (!loginBtn.parentNode.querySelector('.dropdown-menu')) {
        const dropdownMenu = document.createElement('div');
        dropdownMenu.className = 'dropdown-menu';
        dropdownMenu.innerHTML = `
          <a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a>
          <a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#" id="logoutBtn"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
        `;
        
        loginBtn.parentNode.appendChild(dropdownMenu);
        
        // Add logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
          e.preventDefault();
          window.firebaseAuth.signOut();
          location.reload();
        });
      }
    }
  }

  // Check if user is already logged in
  window.firebaseAuth.onAuthStateChanged((user) => {
    if (user) {
      updateNavigationForLoggedInUser(user);
    }
  });

  // Clear forms when modals are hidden
  document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('hidden.bs.modal', function() {
      const forms = this.querySelectorAll('form');
      forms.forEach(form => form.reset());
      
      // Clear alerts
      document.querySelectorAll('.alert-message').forEach(alert => alert.remove());
    });
  });
</script>

<script>
  // Your existing theme and scroll functionality
  const toggleBtn = document.getElementById('themeToggle');
  const icon = toggleBtn.querySelector('i');
  const root = document.body;
  const savedTheme = localStorage.getItem('theme');

  if (savedTheme) root.dataset.theme = savedTheme;

  const setIcon = () => {
    icon.className = root.dataset.theme === 'light' ? 'bi-moon' : 'bi-sun';
  };
  setIcon();

  toggleBtn.addEventListener('click', () => {
    const current = root.dataset.theme;
    const next = current === 'light' ? 'dark' : 'light';
    root.dataset.theme = next;
    localStorage.setItem('theme', next);
    setIcon();
  });

  // Smooth scrolling for navigation links
  document.querySelectorAll('a.nav-link').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href');
      const targetElement = document.querySelector(targetId);
      
      window.scrollTo({
        top: targetElement.offsetTop - 80,
        behavior: 'smooth'
      });
    });
  });

  // Scroll animation
  const scrollElements = document.querySelectorAll('.scroll-animate');
  
  const elementInView = (el, dividend = 1) => {
    const elementTop = el.getBoundingClientRect().top;
    return (
      elementTop <=
      (window.innerHeight || document.documentElement.clientHeight) / dividend
    );
  };
  
  const displayScrollElement = (element) => {
    element.classList.add('animated');
  };
  
  const hideScrollElement = (element) => {
    element.classList.remove('animated');
  };
  
  const handleScrollAnimation = () => {
    scrollElements.forEach((el) => {
      if (elementInView(el, 1.2)) {
        displayScrollElement(el);
      } else {
        hideScrollElement(el);
      }
    });
  };
  
  window.addEventListener('scroll', () => {
    handleScrollAnimation();
  });
  
  // Initialize animations on page load
  document.addEventListener('DOMContentLoaded', function() {
    handleScrollAnimation();
  });
</script>
</body>
</html>